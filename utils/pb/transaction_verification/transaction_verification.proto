syntax = "proto3";

package transaction_verification;

// The service definition
service TransactionVerificationService {
  rpc InitializeOrder (TransactionInitRequest) returns (TransactionInitResponse);
  rpc VerifyTransaction (TransactionRequest) returns (TransactionResponse);
}

message TransactionInitRequest {
  string order_id = 1;
  string creditCardNumber = 2;
  string expiryDate = 3; // same format "MM/YY" or "MM/YYYY"
  string billingStreet = 4;
  string billingCity = 5;
  string billingState = 6;
  string billingZip = 7;
  string billingCountry = 8;
  map<string, int32> vectorClock = 9;
}

message TransactionInitResponse {
  bool success = 1;
  map<string, int32> vectorClock = 2; 
}

// Request message
message TransactionRequest {
  string creditCardNumber = 1;
  string expiryDate = 2; // format: "MM/YY" or "MM/YYYY"
  string order_id = 3;
  string billingCity = 4;
  string billingState = 5;
  string billingZip = 6;
  string billingCountry = 7;
  map<string, int32> vectorClock = 8; 
}

// Response message
message TransactionResponse {
  bool isValid = 1;
  string reason = 2; 
  map<string, int32> vectorClock = 3; 
}
